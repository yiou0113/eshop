<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>訂單詳情</title>
    <meta charset="UTF-8">
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet">
    <link rel="stylesheet" th:href="@{/resources/css/style.css}" />
    
    <style>
        body {
            background-color: #f8f9fa;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 60px;
        }

        .order-container {
            background-color: #ffffff;
            width: 70%;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        h2, h3 {
            text-align: center;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            text-align: center;
        }

        .amount {
            text-align: right;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 25px;
        }

        .order-info p {
            font-size: 1.1rem;
            text-align: center;
        }

        .order-info strong {
            color: #0d6efd;
        }

        /* 將表格標題背景變淡藍色 */
        thead.table-light th {
            background-color: #e3f2fd !important;
        }
    </style>
</head>
<body>
    <div class="order-container">
        <h2>訂單詳情</h2>

        <div class="order-info mb-4">
            <p><strong>訂單編號：</strong><span th:text="${order.id}"></span></p>
            <p><strong>狀態：</strong><span th:text="${order.status}"></span></p>
            <p><strong>總金額：</strong><span th:text="${'NT$ ' + #numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')}"></span></p>
        </div>

        <h3>商品明細</h3>
        <table class="table table-bordered align-middle">
            <thead class="table-light">
                <tr>
                    <th>商品名稱</th>
                    <th>數量</th>
                    <th>單價</th>
                    <th>小計</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item : ${order.items}">
                    <td th:text="${item.product.name}"></td>
                    <td th:text="${item.quantity}"></td>
                    <td class="amount" th:text="${'NT$ ' + #numbers.formatDecimal(item.product.price, 0, 'COMMA', 0, 'POINT')}"></td>
                    <td class="amount" th:text="${'NT$ ' + #numbers.formatDecimal(item.subtotal, 0, 'COMMA', 0, 'POINT')}"></td>
                </tr>
            </tbody>
        </table>

        <div class="btn-group">
            <!-- 付款按鈕 -->
            <form th:if="${order.status == '待付款'}"
                  th:action="@{/orders/{id}/pay(id=${order.id})}"
                  method="post" style="display:inline">
                <button type="submit" class="btn btn-success px-4">付款</button>
            </form>

            <!-- 取消按鈕 -->
            <form th:if="${order.status == '待付款'}"
                  th:action="@{/orders/{id}/cancel(id=${order.id})}"
                  method="post" style="display:inline">
                <button type="submit" class="btn btn-danger px-4">取消訂單</button>
            </form>

            <!-- 返回按鈕 -->
            <a class="btn btn-secondary px-4" th:href="@{/orders}">返回訂單列表</a>
        </div>
    </div>
</body>
</html>
